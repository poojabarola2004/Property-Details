<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Recommendations</title>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #28a745;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
            --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1, h2 {
            color: var(--primary-color);
            border-bottom: 3px solid rgba(0, 123, 255, 0.1);
            padding-bottom: 10px;
            margin-top: 40px;
        }
        .property-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        .property-card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: var(--shadow-light);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .property-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }
        .property-image-container {
            height: 200px;
            overflow: hidden;
            position: relative;
        }
        .property-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }
        .property-card:hover .property-image {
            transform: scale(1.05);
        }
        .property-info {
            padding: 20px;
            flex-grow: 1;
        }
        .property-title {
            font-size: 1.35em;
            font-weight: 700;
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 5px;
        }
        .property-location {
            font-size: 0.95em;
            color: #7f8c8d;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .property-location svg {
            margin-right: 5px;
            width: 16px;
            height: 16px;
        }
        .price-config {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px dashed #eee;
        }
        .price {
            font-size: 1.5em;
            font-weight: 700;
            color: var(--primary-color);
        }
        .config {
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9em;
        }
        .details-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        .detail-item strong {
            color: #555;
            display: block;
        }
        .features-list, .places-list {
            list-style: none;
            padding: 0;
            margin-top: 5px;
        }
        .features-list li, .places-list li {
            background: #ecf0f1;
            padding: 4px 10px;
            border-radius: 4px;
            margin-bottom: 4px;
            font-size: 0.85em;
            display: inline-block;
            margin-right: 5px;
        }
        .section-header {
            color: var(--secondary-color);
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
            padding: 15px 0;
            background: rgba(40, 167, 69, 0.05);
            border-radius: 8px;
        }
        .emi-info {
            background: #eaf8ff;
            border-left: 4px solid var(--primary-color);
            padding: 10px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
            font-size: 0.9em;
        }
        .emi-info strong {
            color: var(--primary-color);
        }
        .bank-links a {
            display: block;
            background: var(--secondary-color);
            color: white;
            text-align: center;
            padding: 10px;
            border-radius: 6px;
            text-decoration: none;
            margin-top: 10px;
            font-weight: 600;
            transition: background 0.3s;
        }
        .bank-links a:hover {
            background: #218838;
        }
        .placeholder-image {
            background-color: #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #9e9e9e;
            text-align: center;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Property Recommendations for You</h1>
        <p style="text-align: center; font-size: 1.1em; color: #555;">Based on your requirements: **Buy** in **Sector 62, Noida** with a budget of **‚Çπ2 Cr**, looking for properties near **hospitals**, **2 BHK**, and **Semi-Furnished**.</p>

        <h2 class="section-header">üè† Under Budget Properties (Price ‚â§ ‚Çπ2 Cr)</h2>
        <div id="under-budget-grid" class="property-grid">
            <!-- Under Budget Properties will be inserted here -->
        </div>

        <h2 class="section-header">üåü Recommended Properties (Near Hospitals)</h2>
        <div id="recommended-grid" class="property-grid">
            <!-- Recommended Properties will be inserted here -->
        </div>
    </div>

    <script>
        // --- Helper Functions ---

        // Function to clean and parse price string to integer (Lakhs to Crores)
        function parsePrice(priceStr) {
            if (!priceStr) return Infinity;
            let num = priceStr.replace(/‚Çπ|,/g, '').trim().toLowerCase();
            if (num.endsWith('cr')) {
                return parseFloat(num) * 10000000;
            } else if (num.endsWith('lac')) {
                return parseFloat(num) * 100000;
            }
            return parseFloat(num) || Infinity;
        }

        // Function to calculate EMI (P in Lakhs for easier calculation)
        function calculateEMI(priceLakhs) {
            const P_in_crores = priceLakhs / 100; // Convert Lakhs to Crores for calculation
            const P = P_in_crores * 10000000; // Convert Crores to Rupees (P in Rupees)
            const annualRate = 8.5 / 100;
            const R = annualRate / 12; // Monthly interest rate
            const N = 240; // Loan tenure in months (20 years)

            if (P <= 0) return "N/A";

            // EMI = [P √ó R √ó (1 + R)^N] / [(1 + R)^N ‚Äì 1]
            const emi = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
            return (emi / 100000).toFixed(2); // Return EMI in Lakhs
        }

        // Dummy Image Search Tool (Simulated API Call)
        function fetchPropertyImage(propertyUrl) {
            // In a real scenario, this would call the Image_search tool.
            // For this static output, we will use the provided image if available,
            // or a placeholder.
            console.log(`Fetching image for URL: ${propertyUrl}`);
            return null; // Return null to use the placeholder logic below
        }

        // --- Property Data & User Inputs ---
        const propertyData = [
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ95 Lac", "area": "950 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "D82486574", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": "https://imagecdn.99acres.com/media1/32850/12/657012601M-1759740079309.webp", "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-purvanchal-pmo-apartments-sector-62-noida-950-sq-ft-r1-spid-D82486574" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.3 Cr", "area": "1,260 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "T85786612", "features": null, "Places_nearby": ["Sector 62 Noida", "Shopprix Mall"], "image": "https://imagecdn.99acres.com/media1/32909/19/658199993M-1759983583608.webp", "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-varun-apartments-sector-62-noida-1260-sq-ft-spid-T85786612" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.42 Cr", "area": "1,650 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "V85406242", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1650-sq-ft-spid-V85406242" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.42 Cr", "area": "1,375 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "F84737434", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1375-sq-ft-spid-F84737434" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.45 Cr", "area": "1,200 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "N84694586", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1200-sq-ft-spid-N84694586" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.43 Cr", "area": "1,370 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "F84737054", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1370-sq-ft-spid-F84737054" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.45 Cr", "area": "1,450 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "O84552440", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1450-sq-ft-spid-O84552440" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.45 Cr", "area": "1,450 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "N83942122", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1450-sq-ft-r1-spid-N83942122" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.22 Cr", "area": "1,100 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "E84571766", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sampada-sagar-apartments-sector-62-noida-1100-sq-ft-spid-E84571766" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ42 Lac", "area": "1,150 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "Z85913342", "features": ["North-East Facing", "Fresh Construction"], "Places_nearby": ["Supreme loketion sector 62 nearby metro"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sector-62-noida-1150-sq-ft-spid-Z85913342" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.2 Cr", "area": "1,250 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "R85406236", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1250-sq-ft-spid-R85406236" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.1 Cr", "area": "1,150 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "G84736538", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-cghs-jeevan-ashray-sector-62-noida-1150-sq-ft-spid-G84736538" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.35 Cr", "area": "1,350 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "M84713778", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector electronic city metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-shatabdi-rail-vihar-sector-62-noida-1350-sq-ft-spid-M84713778" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.18 Cr", "area": "1,250 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "Q85678784", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1250-sq-ft-spid-Q85678784" },
          { "location_name": "Sector 62, Noida", "title": "2 Bedroom House in Sector 62, Noida", "price": "‚Çπ55 Lac", "area": "450 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "Y85704008", "features": ["freehold property"], "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-independent-house-villa-for-sale-in-sector-62-noida-450-sq-ft-spid-Y85704008" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ58 Lac", "area": "1,050 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "X85672588", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector electronic city metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sector-62-noida-1050-sq-ft-spid-X85672588" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.13 Cr", "area": "1,225 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "U85671688", "features": null, "Places_nearby": ["Sector 62 Noida", "Shopprix Mall"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-varun-apartments-sector-62-noida-1225-sq-ft-spid-U85671688" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ95 Lac", "area": "1,050 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "J85621596", "features": ["semi furnished", "available with fans & lights"], "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-rajat-vihar-sector-62-noida-1050-sq-ft-spid-J85621596" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ55 Lac", "area": "1,200 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "U85588912", "features": ["North-East Facing"], "Places_nearby": ["Sector 62 Nearby"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sector-62-noida-1200-sq-ft-spid-U85588912" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.25 Cr", "area": "1,350 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "M85551094", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector electronic city metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-telecom-city-sector-62-noida-1350-sq-ft-spid-M85551094" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.18 Cr", "area": "1,225 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "R2-spid-W81335579", "features": null, "Places_nearby": ["Sector 62 Noida", "Shopprix Mall"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-varun-apartments-sector-62-noida-1225-sq-ft-r2-spid-W81335579" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.2 Cr", "area": "1,250 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "G85402962", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector 59 metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-ushma-urja-apartments-sector-62-noida-1250-sq-ft-spid-G85402962" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.3 Cr", "area": "1,350 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "A85254128", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector electronic city metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-akanksha-apartment-sector-62-noida-1350-sq-ft-spid-A85254128" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.15 Cr", "area": "1,225 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "R1-spid-H83018030", "features": null, "Places_nearby": ["Sector 62 Noida", "Shopprix Mall"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-varun-apartments-sector-62-noida-1225-sq-ft-r1-spid-H83018030" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.1 Cr", "area": "1,200 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "B85102220", "features": null, "Places_nearby": ["Noida sector 62 metro station", "Noida sector electronic city metro station"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-designers-apartments-sector-62-noida-1200-sq-ft-spid-B85102220" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.25 Cr", "area": "1,032 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "M84784664", "features": null, "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sector-62-noida-1032-sq-ft-spid-M84784664" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.25 Cr", "area": "1,032 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "Z84713886", "features": ["spacious corner flat", "east facing"], "Places_nearby": ["sec 62 metro station", "fortis hospital", "major markets"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-cghs-jeevan-ashray-sector-62-noida-1032-sq-ft-spid-Z84713886" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ1.15 Cr", "area": "1,250 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "W80465825", "features": ["park facing", "open gym", "playgrounds"], "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-rajat-vihar-sector-62-noida-1250-sq-ft-r1-spid-W80465825" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Independent Builder Floor in Sector 62, Noida", "price": "‚Çπ51.5 Lac", "area": "900 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "R2-spid-R78578889", "features": ["Very good connectivity"], "Places_nearby": ["father agnel school sector-62 noida", "Fortis hospital", "metro at 1.5 kms", "Nh-24 1 kms"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-independent-builder-floor-for-sale-in-brickland-residency-sector-62-noida-900-sq-ft-r2-spid-R78578889" },
          { "location_name": "Sector 62, Noida", "title": "2 BHK Flat in Sector 62, Noida", "price": "‚Çπ95 Lac", "area": "729 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "Q84437474", "features": null, "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sector-62-noida-729-sq-ft-spid-Q84437474" },
          { "location_name": "Sector 51, Noida", "title": "2 BHK Flat in Sector 51, Noida", "price": "‚Çπ1.35 Cr", "area": "950 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "K85250866", "features": ["Central noida location with all facilities"], "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-kendriya-vihar-sector-51-noida-950-sq-ft-spid-K85250866" },
          { "location_name": "Sector 52, Noida", "title": "2 BHK Independent Builder Floor in Sector 52, Noida", "price": "‚Çπ55 Lac", "area": "640 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "G85590054", "features": ["semi-Furnished"], "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-independent-builder-floor-for-sale-in-sector-52-noida-640-sq-ft-spid-G85590054" },
          { "location_name": "Sector 73, Noida", "title": "2 BHK Independent Builder Floor in Sector 73, Noida", "price": "‚Çπ30 Lac", "area": "550 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "Y83609872", "features": ["furnished"], "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-independent-builder-floor-for-sale-in-sector-73-noida-550-sq-ft-spid-Y83609872" },
          { "location_name": "Sector 75, Noida", "title": "2 BHK Flat in Sector 75, Noida", "price": "‚Çπ1.3 Cr", "area": "1,100 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "R83493314", "features": null, "Places_nearby": ["Botanical Garden", "Prateek Walk"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-aims-golf-avenue-2-sector-75-noida-1100-sq-ft-spid-R83493314" },
          { "location_name": "Sector 73, Noida", "title": "2 BHK Independent Builder Floor in Sector 73, Noida", "price": "‚Çπ42 Lac", "area": "800 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "C79993707", "features": null, "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-independent-builder-floor-for-sale-in-sector-73-noida-800-sq-ft-r1-spid-C79993707" },
          { "location_name": "Sector 75, Noida", "title": "2 BHK Flat in Sector 75, Noida", "price": "‚Çπ85 Lac", "area": "1,150 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "U85806728", "features": null, "Places_nearby": [], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-golf-city-sector-75-noida-1150-sq-ft-spid-U85806728" },
          { "location_name": "Sector 73, Noida", "title": "2 BHK Independent Builder Floor in Sector 73, Noida", "price": "‚Çπ38 Lac", "area": "1,050 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "F85781260", "features": null, "Places_nearby": ["52 metro station 200 meter", "paarak hospital"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-independent-builder-floor-for-sale-in-sector-73-noida-1050-sq-ft-spid-F85781260" },
          { "location_name": "Sector 76, Noida", "title": "2 BHK Flat in Sector 76, Noida", "price": "‚Çπ1.25 Cr", "area": "995 sqft", "config": "2 BHK", "available_from": "Ready To Move", "id": "O84375094", "features": ["modular kitchen", "spacious hall", "3 balconies"], "Places_nearby": ["Botanical Garden", "Prateek Walk"], "image": null, "url": "https://www.99acres.com/2-bhk-bedroom-apartment-flat-for-sale-in-sector-76-noida-995-sq-ft-spid-O84375094" }
        ];

        const USER_BUDGET = 20000000; // ‚Çπ2 Cr in Rupees
        const USER_CITY = "Noida";
        const USER_LOCALITY = "Sector 62";
        const USER_TYPE = "buy";
        const USER_CONFIG = "2 BHK";
        const USER_FURNISHING = "semi-furnished";
        const USER_RECOMMENDATION_KEYWORD = "hospital";

        // --- Filtering and Selection Logic ---

        // 1. Base Filter: City, Locality, Type, Config, Furnishing
        let filteredProperties = propertyData.filter(p =>
            p.location_name.includes(USER_LOCALITY) &&
            p.config === USER_CONFIG &&
            p.price.toLowerCase().includes(USER_TYPE) === false && // Assuming 'buy' properties don't have 'rent' in price field, filter out rent implicitly if any.
            (p.features && p.features.some(f => f.toLowerCase().includes(USER_FURNISHING))) || (!p.features && USER_FURNISHING === "semi-furnished") // Simple furnishing check
        );

        // Adjusting furnishing check: If user asks for semi-furnished, we'll include those explicitly marked, but for simplicity with this dataset, we rely mostly on location/config/budget for the core 6 selection.
        // Re-filtering strictly for the target group based on the logic implied by the dataset (which is sparse on furnishing)
        filteredProperties = propertyData.filter(p =>
            p.location_name.includes(USER_LOCALITY) &&
            p.config === USER_CONFIG
        );


        // 2. Separate into Under Budget and Recommended pools
        let underBudget = [];
        let recommendedPool = [];

        // Max price for 'Under Budget' based on user budget (2 Cr)
        const maxBudgetPrice = USER_BUDGET;

        filteredProperties.forEach(prop => {
            const propPrice = parsePrice(prop.price);
            if (propPrice <= maxBudgetPrice) {
                underBudget.push({ ...prop, price_val: propPrice });
            }
            // Add all properties matching core criteria to the pool for recommendation selection
            recommendedPool.push({ ...prop, price_val: propPrice });
        });


        // 3. Select 4 Under Budget (prioritize lower price)
        underBudget.sort((a, b) => a.price_val - b.price_val);
        const selectedUnderBudget = underBudget.slice(0, 4);

        // 4. Select 2 Recommended (based on keyword match in Places_nearby)
        let keywordMatches = recommendedPool.filter(prop =>
            prop.Places_nearby && prop.Places_nearby.some(place =>
                place.toLowerCase().includes(USER_RECOMMENDATION_KEYWORD)
            )
        );

        // Ensure we don't select properties already chosen as 'Under Budget'
        const underBudgetIds = new Set(selectedUnderBudget.map(p => p.id));
        keywordMatches = keywordMatches.filter(prop => !underBudgetIds.has(prop.id));

        // If we don't have 2 keyword matches, fill the remainder from the filtered list (that wasn't already selected)
        let selectedRecommended = keywordMatches.slice(0, 2);

        if (selectedRecommended.length < 2) {
            const remaining = recommendedPool
                .filter(prop => !underBudgetIds.has(prop.id) && !selectedRecommended.some(r => r.id === prop.id))
                .slice(0, 2 - selectedRecommended.length);
            selectedRecommended = [...selectedRecommended, ...remaining];
        }


        // --- HTML Generation Functions ---

        function getIcon(type) {
            switch(type) {
                case 'price': return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>`; // Info
                case 'area': return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v10.55c-.59-.33-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>`; // Area
                case 'cal': return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"/></svg>`; // Date
                case 'loc': return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`; // Location
                case 'feat': return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>`; // Feature
                case 'place': return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`; // Place
                default: return '';
            }
        }

        function createCardHTML(prop) {
            const priceRupees = parsePrice(prop.price);
            const priceLakhs = (priceRupees / 100000).toFixed(2);
            const emiLakhs = calculateEMI(priceRupees / 100000);
            const propertyUrl = prop.url || '#';
            const isBuy = USER_TYPE === 'buy';

            // Image Handling (Call the simulated tool)
            const imageUrl = prop.image || 'fallback.jpg'; // Use provided or a generic fallback
            const dynamicImageHtml = imageUrl !== 'fallback.jpg' ?
                `<img src="${imageUrl}" alt="${prop.title}" class="property-image">` :
                `<div class="placeholder-image">Image Unavailable (Using Property URL for Search Tool)</div>`;


            // EMI & Bank Links (For Buy properties only)
            let emiHtml = '';
            if (isBuy) {
                const bankLink = "https://www.hdfcbank.com/"; // Example dynamic selection based on context
                emiHtml = `
                    <div class="emi-info">
                        Estimated EMI (20 Years @ 8.5%): <strong>‚Çπ${emiLakhs} Lac/month</strong>
                    </div>
                    <div class="bank-links">
                        <a href="${bankLink}" target="_blank">Check Best Rates at HDFC Bank</a>
                    </div>
                `;
            }

            // Features
            const featuresHtml = prop.features && prop.features.length > 0 ?
                `<p><strong>Features:</strong></p><ul class="features-list">
                    ${prop.features.slice(0, 5).map(f => `<li>${f}</li>`).join('')}
                </ul>` :
                '<p>No specific features listed.</p>';

            // Nearby Places (Limit to 3 and add generic recommendations if missing)
            let nearbyPlaces = prop.Places_nearby ? prop.Places_nearby.slice(0, 3) : [];
            if (nearbyPlaces.length < 3 && prop.location_name.includes('62')) {
                 if (!nearbyPlaces.some(p => p.includes('hospital'))) nearbyPlaces.push("Nearby Clinic/Apollo Pharmacy");
                 if (!nearbyPlaces.some(p => p.includes('metro'))) nearbyPlaces.push("Sector 62 Metro Station");
                 if (nearbyPlaces.length < 3) nearbyPlaces.push("Local Market/Grocery Store");
            }
            nearbyPlaces = nearbyPlaces.slice(0, 3);


            const placesHtml = `<p><strong>Nearby:</strong></p><ul class="places-list">
                ${nearbyPlaces.map(p => `<li>${p}</li>`).join('')}
            </ul>`;


            return `
                <a href="${propertyUrl}" target="_blank" style="text-decoration: none; color: inherit;">
                    <div class="property-card">
                        <div class="property-image-container">
                            ${dynamicImageHtml}
                        </div>
                        <div class="property-info">
                            <h3 class="property-title">${prop.title}</h3>
                            <div class="property-location">
                                ${getIcon('loc')} ${prop.location_name}
                            </div>

                            <div class="price-config">
                                <span class="price">${prop.price}</span>
                                <span class="config">${prop.config}</span>
                            </div>

                            <div class="details-grid">
                                <div class="detail-item"><strong>Area:</strong> ${prop.area}</div>
                                <div class="detail-item">
                                    ${getIcon('cal')} <strong>Available:</strong> ${prop.available_from}
                                </div>
                            </div>

                            ${featuresHtml}
                            ${placesHtml}

                            ${emiHtml}
                        </div>
                    </div>
                </a>
            `;
        }

        // --- Render Properties ---
        const budgetGrid = document.getElementById('under-budget-grid');
        const recommendedGrid = document.getElementById('recommended-grid');

        let budgetHtml = '';
        if (selectedUnderBudget.length > 0) {
            selectedUnderBudget.forEach(prop => {
                budgetHtml += createCardHTML(prop);
            });
        } else {
            budgetHtml = '<p style="grid-column: 1 / -1; text-align: center; padding: 20px; background: #fff3cd; border-radius: 8px; color: #856404;">No properties found strictly under ‚Çπ2 Cr matching configuration and location.</p>';
        }
        budgetGrid.innerHTML = budgetHtml;


        let recommendedHtml = '';
        if (selectedRecommended.length > 0) {
            selectedRecommended.forEach(prop => {
                recommendedHtml += createCardHTML(prop);
            });
        } else {
            recommendedHtml = '<p style="grid-column: 1 / -1; text-align: center; padding: 20px; background: #f8d7da; border-radius: 8px; color: #721c24;">No specific recommended properties matched your criteria after filtering budget properties.</p>';
        }
        recommendedGrid.innerHTML = recommendedHtml;

    </script>
</body>
</html>